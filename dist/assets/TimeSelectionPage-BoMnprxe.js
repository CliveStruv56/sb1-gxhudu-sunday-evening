import{a as N,j as e,u as $}from"./index-Be7Y3f13.js";import{R as r,u as R}from"./vendor-react-DBFghe8J.js";import{s as v,a as C,b as D,i as T,f as m,d as H}from"./vendor-utils-IHwoJ3uH.js";import"./vendor-firebase-_yAk6ILj.js";const A=({onConfirm:d})=>{const[t,x]=r.useState(null),[o,g]=r.useState(""),[u,i]=r.useState(!1),{settings:c}=N();r.useEffect(()=>{N.getState().fetchSettings()},[]);const b=r.useCallback(s=>{const a=[],l=v(C(s,45),10),h=v(C(s,30),15);let n=l;const p=D(new Date,15);for(;T(h,n);){const j=m(n,"HH:mm"),S=new Date(s),[k,E]=j.split(":").map(Number);S.setHours(k,E,0,0),T(S,p)&&a.push({time:j,available:!0}),n=D(n,15)}return a},[]),f=r.useCallback(s=>{if(!c)return!1;const a=m(s,"yyyy-MM-dd");return!(c.blockedDates.includes(a)||b(s).length===0)},[c,b]),y=r.useMemo(()=>{const s=new Date,a=[];let l=s,h=0;for(;a.length<8&&h<30;){const n=l.getDay();(n===4||n===5||n===6||n===0)&&f(l)&&a.push({date:new Date(l),isToday:m(l,"yyyy-MM-dd")===m(s,"yyyy-MM-dd")}),l=H(l,1),h++}return a},[f]),w=()=>{t&&o&&(d(t,o),i(!0))},M=()=>{x(null),g(""),i(!1)};return c?e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Select Collection Date and Time"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Select Date:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:y.map(({date:s,isToday:a})=>e.jsx("button",{onClick:()=>{x(s),g(""),i(!1)},className:`p-3 rounded-lg border transition-colors ${(t==null?void 0:t.toDateString())===s.toDateString()?"bg-blue-600 text-white":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{children:m(s,"EEE, MMM d")}),a&&e.jsx("span",{className:"text-xs mt-1 font-medium text-green-600",children:"Today"})]})},s.toISOString()))}),y.length===0&&e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"No available dates for collection. Please check back later."})]}),t&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Select Time:"}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-3",children:b(t).map(({time:s,available:a})=>e.jsx("button",{onClick:()=>{a&&(g(s),i(!1))},disabled:!a,className:`p-2 rounded-lg border ${o===s?"bg-blue-600 text-white":a?"hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:s},s))})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:w,disabled:!t||!o,className:`flex-1 py-3 px-4 rounded-lg text-white transition-colors ${u?"bg-green-700 hover:bg-green-800":"bg-green-600 hover:bg-green-700"} disabled:bg-gray-400`,children:u?"Selection Confirmed âœ“":"Confirm Selection"}),e.jsx("button",{onClick:M,className:"flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Reset"})]}),(t||o)&&e.jsxs("div",{className:`${u?"bg-green-50":"bg-gray-50"} p-4 rounded-lg transition-colors`,children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Current Selection:"}),e.jsx("p",{className:"text-gray-700",children:t&&o?`${m(t,"EEEE, MMMM d, yyyy")} at ${o}`:"Selection incomplete"})]})]}):e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},F=()=>{const d=R(),{items:t,setCollectionTime:x}=$(),[o,g]=r.useState(null);r.useEffect(()=>{t.length===0&&d("/")},[t,d]);const u=(i,c)=>{g({date:i,time:c}),x(i,c),d("/checkout")};return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Select Collection Date and Time"}),e.jsxs("div",{className:"bg-white shadow-md rounded-lg mb-8",children:[e.jsx("div",{className:"p-4 border-b text-gray-600",children:"We are open every Thursday, Friday, Saturday and Sunday."}),e.jsx(A,{onConfirm:u})]}),e.jsx("button",{onClick:()=>d("/cart"),className:"w-full bg-gray-200 text-gray-700 py-4 px-6 rounded-lg text-lg font-semibold hover:bg-gray-300 transition-colors",children:"Back to Cart"})]})};export{F as default};
//# sourceMappingURL=TimeSelectionPage-BoMnprxe.js.map
